# P04 — Реестр рисков

Оценки вероятности (L) и влияния (I) приведены по шкале 1…5. Значение `Risk` вычисляется как `L × I`. Все риски связаны с потоками `F1…F12` из `DFD.md` и контролями, перечисленными в `STRIDE.md`.

| RiskID | Описание | Связь (F/NFR) | L | I | Risk | Стратегия | Владелец | Срок | Критерий закрытия |
|--------|----------|---------------|---|---|------|-----------|----------|------|--------------------|
| R1 | Инъекции или обход валидации при создании идей | F1, NFR-02 | 3 | 4 | 12 | Снизить | @backend | 2025-02-15 | Валидация Pydantic покрывает 100% кейсов, `pytest -q` зелёный |
| R2 | Накрутка рейтинга через повторные оценки | F2, NFR-04 | 2 | 3 | 6 | Снизить | @core-service | 2025-03-01 | Тест `tests/security/test_eval_dedup.py` проходит, дубликаты блокируются |
| R3 | Захват админ-доступа через украденный JWT | F4, NFR-01 | 3 | 5 | 15 | Снизить | @auth | 2025-02-20 | RS256 ключи в Vault, TTL ≤ 60 мин, e2e тесты на админ-флоу |
| R4 | DoS при обходе rate limiting на gateway | F1/F2, NFR-03 | 3 | 4 | 12 | Снизить | @api-gateway | 2025-03-10 | k6 `scripts/loadtest/ideas-rate-limit.js` в nightly pipeline — pass |
| R5 | Прямая порча данных в Idea Store | F6/F7, NFR-02 | 2 | 5 | 10 | Снизить | @core-service | 2025-03-15 | Транзакционный guard и валидация статусов задокументированы, тесты зелёные |
| R6 | Отсутствие аудита 401/403 затрудняет расследование | F8, NFR-05 | 2 | 4 | 8 | Снизить | @observability | 2025-04-01 | `scripts/check_security_logs.py` подтверждает ≥95% событий в security.log |
| R7 | Утечка секретов из-за просроченных токенов | F9/F10, NFR-07 | 3 | 5 | 15 | Снизить | @platform | 2025-03-25 | Vault отчёт показывает TTL ≤ 30 дней, job `scripts/secrets_ttl.py` зелёная |
| R8 | Эксплуатация уязвимости зависимости | F11/F12, NFR-06 | 4 | 5 | 20 | Снизить | @devops | 2025-02-10 | Weekly `pip-audit` job падает на High/Critical и создаёт issue |
| R9 | Утечка чувствительных полей в ответах API | F3, NFR-02 | 2 | 4 | 8 | Снизить | @backend | 2025-02-28 | Контрактные тесты `tests/test_ideas.py` подтверждают whitelisting полей |
| R10 | Подмена запросов между gateway и API | F5, NFR-03 | 2 | 5 | 10 | Снизить | @platform | 2025-04-05 | Включена mTLS-политика, Gateway PR чек-лист требует TLS |
